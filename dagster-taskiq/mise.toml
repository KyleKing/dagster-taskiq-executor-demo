# Dagster-TaskIQ-specific mise configuration
# This file defines tasks for the Dagster TaskIQ Library

[env]
PYTHONPATH = "src"

# ==============================================================================
# Common Development Tasks
# ==============================================================================

[tasks.install]
description = "Install deploy dependencies"
run = "uv sync --all-groups"
sources = ["pyproject.toml", "uv.lock"]

[tasks.test]
description = "Run deploy tests with pytest (pass additional args)"
run = "uv run pytest"
sources = ["**/*.py"]

[tasks.format]
description = "Format deploy code with ruff (pass --check to check only)"
run = "uv run ruff format"
sources = ["**/*.py"]

[tasks.lint]
description = "Lint deploy code with ruff (pass --fix to auto-fix)"
run = "uv run ruff check"
sources = ["**/*.py"]

[tasks."lint:power-fix"]
description = "Attempt to fix all lint errors"
run = "mise run lint --fix --unsafe-fiuxes"

[tasks.mypy]
description = "Run mypy type checker (pass additional args)"
run = "uv run mypy"
sources = ["**/*.py"]

[tasks.pyright]
description = "Run pyright type checker (pass additional args)"
run = "uv run pyright"
sources = ["**/*.py"]

[tasks.checks]
description = "Run all read-only checks (lint + typechecks + test)"
depends = ["lint", "mypy", "pyright", "test"]

[tasks.fixes]
description = "Run all fixes (ruff format and linter)"
depends = ["format", "lint:power-fix"]
