[pytest]
# Pytest configuration for Pulumi infrastructure testing
# Following pulumi-testing skill best practices

testpaths = tests

python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Custom markers for different test types
markers =
    integration: Integration tests deploying real infrastructure (deselect with '-m "not integration"')
    unit: Fast unit tests with mocking
    property: Property tests during deployment
    slow: Tests that take >60 seconds
    localstack: Tests requiring LocalStack
    state_sync: Tests requiring state synchronization
    fresh_state: Tests requiring fresh LocalStack state

# Run integration tests by default (not slow ones)
addopts =
    -v
    --tb=short
    -m "not slow"
    --strict-markers
    --color=yes

# Asyncio configuration
asyncio_mode = auto

# Coverage configuration
[coverage:run]
source = components,modules
omit = tests/*,__pycache__/*

[coverage:report]
precision = 2
show_missing = True
skip_covered = False

[coverage:html]
directory = htmlcov
