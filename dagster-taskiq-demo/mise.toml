# App-specific mise configuration
# This file defines tasks for the Dagster TaskIQ application

# ==============================================================================
# Common Development Tasks
# ==============================================================================

[tasks.install]
description = "Install deploy dependencies"
run = "uv sync --all-groups"
sources = ["pyproject.toml", "uv.lock"]
outputs = [".venv"]

[tasks.test]
description = "Run deploy tests with pytest (pass additional args)"
run = "uv run pytest"

[tasks.format]
description = "Format deploy code with ruff (pass --check to check only)"
run = "uv run ruff format"

[tasks.lint]
description = "Lint deploy code with ruff (pass --fix to auto-fix)"
run = "uv run ruff check"

[tasks."lint:power-fix"]
description = "Attempt to fix all lint errors"
run = "mise run lint --fix --unsafe-fixes"

[tasks.mypy]
description = "Run mypy type checker (pass additional args)"
run = "uv run mypy"

[tasks.pyright]
description = "Run pyright type checker (pass additional args)"
run = "uv run pyright"

[tasks.checks]
description = "Run all read-only checks (lint + typechecks + test)"
wait_for = ["lint", "mypy", "pyright", "test"]

[tasks.fixes]
description = "Run all fixes (ruff format and linter)"
wait_for = ["format", "lint:power-fix"]
